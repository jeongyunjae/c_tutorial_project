# 고급 프로그래밍

## 목차

[1. 메모리 배치](#메모리-배치)

[2. 외부 변수](외부-변수)

[3. 정적 외부 변수](정적-외부-변수)

[4. 추상 자료형 스택](추상-자료형-스택)

[5. 가변 인자 함수](#가변-인자-함수)

[6. 자기 참조 구조체](#자기-참조-구조체)

[7. 동적 메모리 할당](#동적-메모리-할당)

[8. 플렉시블 배열](#플렉시블-배열)

## 메모리 배치

C로 만든 프로그램을 실행시키면, 운영체제는 프로그램을 위해 메모리 공간을 할당해줍니다.  

메모리 공간을 크게 **스택**, **힙**, **데이터** 영역으로 볼 수 있는데, 각 영역은 조금씩 차이가 있습니다.  

**그림 추가 예정**  

- 데이터 영역

  데이터 영역은 전역 변수와 정적 변수가 할당되는 영역입니다.  

  프로그램의 시작과 동시에 할당되고, 프로그램이 종료되면 자동으로 메모리에서 소멸됩니다.  

  

- 스택 영역

  스택 영역은 함수 호출 시 생성되는 매개 변수와 지역 변수가 저장되는 영역입니다.  

  함수 호출이 완료되면 자동으로 사라집니다.  

  

- 힙 영역

  힙 영역은 프로그래머가 할당하는 영역입니다.  

  힙 영역을 사용하려면 동적 할당을 사용해야 합니다. **동적 할당 설명한 강의 연결 없으면 설명**  

  

  위에서 설명한 두 영역과 힙 영역의 차이를 간단하게 설명하면 **동적 할당과 해제** 입니다.  

  메모리 해제는 매우 중요합니다. 동적으로 할당한 메모리를 해제해주지 않으면  

  결국에는 메모리 사용량이 많아져 시스템 메모리가 부족하게 되고 운영체제가 프로그램을 강제 종료시키기 때문입니다.  

  예제를 통해 각 영역의 차이를 살펴보고, 어떤 경우에 동적 할당을 해야할지 살펴봅시다.  

**프로그램 x.1**

```
예제 추가 예정
```



## 외부 변수

 소스 파일이 여러개일 때, 다른 소스파일에서 선언한 변수를 사용할 수 있습니다.  

extern 키워드를 사용합니다.  

예)

print.c

```
#include <stdio.h>

int num1 = 10;

void printNum(){
	printf("%d\n", num1);
}
```

  

main.c  

```
#include <stdio.h>

extern int num1;

int main(){
	printf("%d\n", num1)
}
```

위와 같은 방법으로 print.c 에서 선언한 num1을 main.c에서 사용할 수 있습니다.  

주의할 점은 extern 키워드는 **전역 변수를 선언하는 것이 아니라는** 것입니다.  

extern은 num1이 다른 소스 파일에 있다는 것을 표시할 뿐입니다.  

print.c에서 전역변수 num1을 선언하지 않았다면 컴파일 에러가 발생합니다.



## 정적 외부 변수

예제를 먼저 살펴보겠습니다.  

프로그램 x.2  

```
#include <stdio.h>

void increaseNum(){

    int num1 = 0;  
    
    printf("%d\n", num1);  
    num1++;
}

int main()
{
    increaseNum();   
    increaseNum();   
    increaseNum();   
    increaseNum();   

    return 0;
}
```

프로그램 x.2의 출력은 어떻게 될까요?  

**프로그램 결과**

```
0
0
0
0
```

모두 0으로 출력됩니다.  

increaseNum에서 num1++를 했음에도 0이 출력되는 이유는 num이 지역 변수이기 때문입니다.  

함수 호출 시 생성된 지역 변수 num이 함수 호출이 끝났으니 사라져 버리는 것이죠. (참고) [메모리 배치](#메모리-배치)  



변수가 사라지지 않게 하려면 정적 변수를 사용해야 합니다.  

정적 변수는 static 키워드를 사용합니다.  

```
#include <stdio.h>

void increaseNum(){

    static int num1 = 0;  
    
    printf("%d\n", num1);  
    num1++;
}

int main()
{
    increaseNum();   
    increaseNum();   
    increaseNum();   
    increaseNum();   

    return 0;
}
```

위와 같이 프로그램을 수정하게 되면,  

프로그램이 시작될 때 static int num1 = 0을 초기화하고 함수가 시작할 때는 변수를 초기화하지 않고 무시합니다.  

그래서 출력은

```
0
1
2
3
```

이 나오는 것이죠.  



만약 전역 변수를 정적 변수로 선언한다면 어떻게 될까요?  

전역 변수, 정적 변수 모두 값이 계속 유지되지만 정적 변수는 extern을 이용해 다른 소스파일에서 사용할 수 없습니다.  

또한 정적 변수는 함수의 매개변수로 사용할 수 없습니다. 예를 들어 

```
void increaseNum(static int num1){
...
}
```

은 잘못된 문법입니다.  



또 함수에도 static 키워드를 사용해 정적 외부 함수로 만들 수 있습니다.  

정적 외부 함수 또한 다른 소스 파일에서는 사용이 불가능 하기 때문에  

이 점을 이용해 **다른 소스 파일에서 이름이 같은 함수를 선언할 수 있습니다.(함수 이름 중복이 가능합니다)**

예를 들어 print.c에 print()함수를 선언하고 main.c에도 print.c 함수를 선언하고 컴파일을 하면 에러가 나지만,  

(한 프로그램 내에서 같은 이름의 함수가 존재할 수 없기 때문에)

print.c가 static 함수라면 에러가 나지 않습니다.  

## 추상 자료형 스택



## 가변 인자 함수

## 자기 참조 구조체

## 동적 메모리 할당

## 플렉시블 배열

